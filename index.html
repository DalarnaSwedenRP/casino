<!DOCTYPE html>
<html lang="sv">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Dalarna Sweden RP Casino</title>
  <style>
    body {
      background-color: #121212;
      color: #e0e0e0;
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 0;
    }
    .container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 20px;
    }
    header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 10px 0;
    }
    header h1 {
      font-size: 2em;
      margin: 0;
    }
    .account-info {
      display: flex;
      align-items: center;
      gap: 10px;
    }
    .account-info button {
      background-color: #6200ea;
      color: white;
      border: none;
      padding: 8px 16px;
      cursor: pointer;
      border-radius: 5px;
    }
    .account-info button:hover {
      background-color: #3700b3;
    }
    .popup {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.7);
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 1000;
    }
    .popup-content {
      background: #1e1e1e;
      padding: 20px;
      border-radius: 10px;
      text-align: center;
      max-width: 400px;
    }
    .popup-content button {
      background-color: #6200ea;
      color: white;
      border: none;
      padding: 10px 20px;
      cursor: pointer;
      border-radius: 5px;
      margin-top: 10px;
    }
    .form-container {
      display: none;
      background: #1e1e1e;
      padding: 20px;
      border-radius: 10px;
      max-width: 400px;
      margin: 20px auto;
    }
    .form-container input {
      width: 100%;
      padding: 10px;
      margin: 10px 0;
      border: none;
      border-radius: 5px;
      background: #2c2c2c;
      color: #e0e0e0;
    }
    .form-container button {
      background-color: #6200ea;
      color: white;
      border: none;
      padding: 10px;
      cursor: pointer;
      border-radius: 5px;
      width: 100%;
    }
    .game-section {
      margin: 20px 0;
    }
    .game-section h2 {
      font-size: 1.5em;
    }
    .spin-grid {
      display: grid;
      grid-template-columns: repeat(7, 50px);
      gap: 5px;
      margin: 20px auto;
      width: fit-content;
    }
    .spin-cell {
      width: 50px;
      height: 50px;
      background: #2c2c2c;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 5px;
    }
    .slots-container {
      display: flex;
      gap: 10px;
      justify-content: center;
    }
    .slot {
      width: 60px;
      height: 60px;
      background: #2c2c2c;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 5px;
      font-size: 1.2em;
    }
    .wheel {
      width: 200px;
      height: 200px;
      background: #2c2c2c;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      margin: 20px auto;
      font-size: 1.5em;
    }
  </style>
</head>
<body>
  <div class="popup" id="disclaimerPopup">
    <div class="popup-content">
      <p>Denna sida använder endast fejk-pengar och inte riktiga pengar. Inget spel här är på riktigt.</p>
      <button onclick="closePopup()">OK</button>
    </div>
  </div>

  <div class="container">
    <header>
      <h1>Dalarna Sweden RP Casino</h1>
      <div class="account-info" id="accountInfo">
        <button onclick="showCreateAccount()">Skapa konto</button>
        <button onclick="showLogin()">Logga in</button>
      </div>
    </header>

    <div class="form-container" id="createAccountForm">
      <h2>Skapa konto</h2>
      <input type="text" id="createMessengerName" placeholder="Messenger Namn" required>
      <input type="password" id="createPassword" placeholder="Lösenord" required>
      <label><input type="checkbox" id="terms" required> Jag godkänner <a href="#">villkoren</a></label>
      <button onclick="createAccount()">Skapa</button>
    </div>

    <div class="form-container" id="loginForm">
      <h2>Logga in</h2>
      <input type="text" id="loginMessengerName" placeholder="Messenger Namn" required>
      <input type="password" id="loginPassword" placeholder="Lösenord" required>
      <button onclick="login()">Logga in</button>
    </div>

    <div class="form-container" id="depositForm" style="display: none;">
      <h2>Lägg in pengar</h2>
      <input type="number" id="depositAmount" placeholder="Belopp" required>
      <input type="password" id="depositPassword" placeholder="Lösenord" required>
      <button onclick="deposit()">Acceptera</button>
    </div>

    <div class="game-section" id="spinGame">
      <h2>Spin</h2>
      <p>Kostar 50 kr per snurr</p>
      <button onclick="playSpin()">Snurra (50 kr)</button>
      <div class="spin-grid" id="spinGrid"></div>
    </div>

    <div class="game-section" id="slotsGame">
      <h2>Slots</h2>
      <p>Kostar 50 kr per snurr</p>
      <button onclick="playSlots()">Snurra (50 kr)</button>
      <div class="slots-container" id="slotsResult"></div>
    </div>

    <div class="game-section" id="wheelGame">
      <h2>Multiplier-hjul</h2>
      <input type="number" id="wheelAmount" placeholder="Satsa belopp" required>
      <button onclick="playWheel()">Snurra</button>
      <div class="wheel" id="wheelResult">?</div>
    </div>
  </div>

  <script>
    // LocalStorage handling
    function getAccounts() {
      return JSON.parse(localStorage.getItem('accounts')) || {};
    }

    function saveAccounts(accounts) {
      localStorage.setItem('accounts', JSON.stringify(accounts));
    }

    function getCurrentUser() {
      return localStorage.getItem('currentUser');
    }

    function setCurrentUser(username) {
      localStorage.setItem('currentUser', username);
    }

    // Simulated GitHub API for logging (replace with actual API calls)
    async function logToGitHub(file, content) {
      console.log(`Logging to ${file}: ${content}`);
      // For actual GitHub integration, use GitHub API with a personal access token
      // Example (not functional in static GitHub Pages without proxy):
      /*
      const response = await fetch('https://api.github.com/repos/USERNAME/REPO/contents/' + file, {
        method: 'PUT',
        headers: {
          'Authorization': 'token YOUR_TOKEN',
          'Content-Type': 'application/json'
        },
        body: JSON.stringify({
          message: 'Update log',
          content: btoa(content),
          sha: 'CURRENT_SHA' // Need to get current SHA
        })
      });
      */
    }

    // Disclaimer popup
    function closePopup() {
      document.getElementById('disclaimerPopup').style.display = 'none';
    }

    // Account creation
    function showCreateAccount() {
      document.getElementById('createAccountForm').style.display = 'block';
      document.getElementById('loginForm').style.display = 'none';
      document.getElementById('depositForm').style.display = 'none';
    }

    function createAccount() {
      const username = document.getElementById('createMessengerName').value;
      const password = document.getElementById('createPassword').value;
      const terms = document.getElementById('terms').checked;

      if (!username || !password || !terms) {
        alert('Fyll i alla fält och godkänn villkoren.');
        return;
      }

      const accounts = getAccounts();
      if (accounts[username]) {
        alert('Användarnamnet finns redan.');
        return;
      }

      accounts[username] = { password, balance: 0 };
      saveAccounts(accounts);
      setCurrentUser(username);
      updateUI();
      document.getElementById('createAccountForm').style.display = 'none';
    }

    // Login
    function showLogin() {
      document.getElementById('loginForm').style.display = 'block';
      document.getElementById('createAccountForm').style.display = 'none';
      document.getElementById('depositForm').style.display = 'none';
    }

    function login() {
      const username = document.getElementById('loginMessengerName').value;
      const password = document.getElementById('loginPassword').value;
      const accounts = getAccounts();

      if (accounts[username] && accounts[username].password === password) {
        setCurrentUser(username);
        updateUI();
        document.getElementById('loginForm').style.display = 'none';
      } else {
        alert('Fel användarnamn eller lösenord.');
      }
    }

    // Deposit
    function deposit() {
      const amount = parseInt(document.getElementById('depositAmount').value);
      const password = document.getElementById('depositPassword').value;
      const username = getCurrentUser();
      const accounts = getAccounts();

      if (!username || accounts[username].password !== password) {
        alert('Fel lösenord.');
        return;
      }

      if (amount <= 0) {
        alert('Ange ett giltigt belopp.');
        return;
      }

      accounts[username].balance += amount;
      saveAccounts(accounts);
      const logEntry = `${username} | +${amount} kr | ${new Date().toISOString()}`;
      logToGitHub('pengaloggar.md', logEntry);
      updateUI();
      document.getElementById('depositForm').style.display = 'none';
    }

    // Update UI based on login status
    function updateUI() {
      const username = getCurrentUser();
      const accounts = getAccounts();
      const accountInfo = document.getElementById('accountInfo');

      if (username && accounts[username]) {
        accountInfo.innerHTML = `Saldo: ${accounts[username].balance} kr <button onclick="showDeposit()">Lägg in pengar</button>`;
        document.getElementById('spinGame').style.display = 'block';
        document.getElementById('slotsGame').style.display = 'block';
        document.getElementById('wheelGame').style.display = 'block';
      } else {
        accountInfo.innerHTML = `
          <button onclick="showCreateAccount()">Skapa konto</button>
          <button onclick="showLogin()">Logga in</button>
        `;
        document.getElementById('spinGame').style.display = 'none';
        document.getElementById('slotsGame').style.display = 'none';
        document.getElementById('wheelGame').style.display = 'none';
      }
    }

    function showDeposit() {
      document.getElementById('depositForm').style.display = 'block';
      document.getElementById('createAccountForm').style.display = 'none';
      document.getElementById('loginForm').style.display = 'none';
    }

    // Spin game
    function playSpin() {
      const username = getCurrentUser();
      const accounts = getAccounts();
      if (!username || accounts[username].balance < 50) {
        alert('Otillräckligt saldo.');
        return;
      }

      accounts[username].balance -= 50;
      saveAccounts(accounts);

      const outcomes = [
        ...Array(13).fill(0),
        ...Array(4).fill(100),
        ...Array(3).fill(500),
        3000
      ];
      const result = outcomes[Math.floor(Math.random() * outcomes.length)];

      const grid = document.getElementById('spinGrid');
      grid.innerHTML = '';
      for (let i = 0; i < 21; i++) {
        const cell = document.createElement('div');
        cell.className = 'spin-cell';
        cell.textContent = i === 10 ? result : Math.floor(Math.random() * 100);
        grid.appendChild(cell);
      }

      if (result > 0) {
        const logEntry = `${username} | +${result} kr | Spin | ${new Date().toISOString()}`;
        logToGitHub('vinster.md', logEntry);
      }

      updateUI();
    }

    // Slots game
    function playSlots() {
      const username = getCurrentUser();
      const accounts = getAccounts();
      if (!username || accounts[username].balance < 50) {
        alert('Otillräckligt saldo.');
        return;
      }

      accounts[username].balance -= 50;
      saveAccounts(accounts);

      const colors = ['red', 'blue', 'green', 'yellow', 'purple'];
      const result = Array(5).fill().map(() => colors[Math.floor(Math.random() * colors.length)]);
      const counts = {};
      result.forEach(c => counts[c] = (counts[c] || 0) + 1);
      const maxCount = Math.max(...Object.values(counts));

      let win = 0;
      if (maxCount === 5) win = 2500;

      const slotsContainer = document.getElementById('slotsResult');
      slotsContainer.innerHTML = '';
      result.forEach(color => {
        const slot = document.createElement('div');
        slot.className = 'slot';
        slot.style.backgroundColor = color;
        slotsContainer.appendChild(slot);
      });

      if (win > 0) {
        const logEntry = `${username} | +${win} kr | Slots | ${new Date().toISOString()}`;
        logToGitHub('vinster.md', logEntry);
      }

      updateUI();
    }

    // Wheel game
    function playWheel() {
      const username = getCurrentUser();
      const accounts = getAccounts();
      const amount = parseInt(document.getElementById('wheelAmount').value);

      if (!username || accounts[username].balance < amount || amount <= 0) {
        alert('Otillräckligt saldo eller ogiltigt belopp.');
        return;
      }

      accounts[username].balance -= amount;
      saveAccounts(accounts);

      const outcomes = [
        ...Array(85).fill(1),
        ...Array(15).fill(2),
        ...Array(15).fill(3),
        ...Array(85).fill(0.5),
        ...Array(85).fill(0.25),
        ...Array(85).fill(0.16),
        ...Array(85).fill(0.125),
        ...Array(85).fill(0.1)
      ];
      const multiplier = outcomes[Math.floor(Math.random() * outcomes.length)];
      const result = amount * multiplier;

      if (result < 0) {
        document.getElementById('wheelResult').textContent = 'Spelet avslutat: Resultat under 0 kr';
        return;
      }

      document.getElementById('wheelResult').textContent = `x${multiplier}`;

      if (multiplier > 1) {
        const win = Math.round(result - amount);
        const logEntry = `${username} | +${win} kr | Multiplier-hjul | ${new Date().toISOString()}`;
        logToGitHub('vinster.md', logEntry);
      }

      updateUI();
    }

    // Initialize
    window.onload = () => {
      updateUI();
    };
  </script>
</body>
</html>
